{
    "Name": "Income Statement",
    "Rules": "#Region System\nFEEDSTRINGS;\nSKIPCHECK;\nUNDEFVALS;\n#EndRegion\n\n\n#['y1','Actual','Local']=STET;\n\n#Region ROW FORMAT\n['RowFormat',{'6000','6005','6010','6015','6300','6310','6320'}]=N:(-1);\n['RowFormat','Total Operating Expense']=2;\n['RowFormat']=IF(ELISANC('Account','TE',!Account)=1,\nELLEV('Account',!Account),STET);\n#EndRegion;\n\n#Region Year on Year Variances\n['Y2-Y1 %' ] =  (['Y2 - Y1 $']\\['Y1'])*100;\n['Y2-Y1 $' ] =  IF(attrn('Account',!Account,'signswitch')=0,['Y1']-['Y2'],['Y2']-['Y1']);\n#EndRegion\n\n#Region Currency Exchange Variances\n# Performance Variance = Budget rate * (Actual Local-Budget Local)\n\n['Performance Variance','Base'] = IF(attrn('Account',!Account,'signswitch')=0, DB('Exchange Rates', ATTRS('Organization', !Organization, 'Currency'), !Year, !Month, 'ExchangeRate', ATTRS('Account', !Account, 'Exchange Rate Type'), DB('Calendar', 'Current\nVersion', 'String')) *\n                                            (DB('Income Statement','Local',!Organization,!Year,!Month,!Account,DB('Calendar', 'Current Version', 'String'))-DB('Income Statement','Local',!Organization,!Year,!Month,!Account,'Actual')), DB('Exchange Rates',\nATTRS('Organization', !Organization, 'Currency'), !Year, !Month, 'ExchangeRate', ATTRS('Account', !Account, 'Exchange Rate Type'), DB('Calendar', 'Current Version', 'String')) *\n                                            (DB('Income Statement','Local',!Organization,!Year,!Month,!Account,'Actual')-DB('Income Statement','Local',!Organization,!Year,!Month,!Account,DB('Calendar', 'Current Version', 'String'))));\n# Currency Exchange Variance = (Actual Rate - Budget rate)*Actual Local\n\n['Ccy Exchange Variance','Base'] = IF(attrn('Account',!Account,'signswitch')=0,( DB('Exchange Rates', ATTRS('Organization', !Organization, 'Currency'), !Year, !Month, 'ExchangeRate', ATTRS('Account', !Account, 'Exchange Rate Type'), DB('Calendar', 'Curren\nt Version', 'String'))-\n                    \t                             DB('Exchange Rates', ATTRS('Organization', !Organization, 'Currency'), !Year, !Month, 'ExchangeRate', ATTRS('Account', !Account, 'Exchange Rate Type'), 'Actual'))*\n                                                 DB('Income Statement','Local',!Organization,!Year,!Month,!Account,'Actual'),( DB('Exchange Rates', ATTRS('Organization', !Organization, 'Currency'), !Year, !Month, 'ExchangeRate', ATTRS('Account', !Account,\n 'Exchange Rate Type'), 'Actual')-\n                    \t                             DB('Exchange Rates', ATTRS('Organization', !Organization, 'Currency'), !Year, !Month, 'ExchangeRate', ATTRS('Account', !Account, 'Exchange Rate Type'), DB('Calendar', 'Current Version', 'String')))*\n                                                 DB('Income Statement','Local',!Organization,!Year,!Month,!Account,'Actual'));\n#EndRegion\n\n#Region Variance calculation for Custom Version\n\n['Variance']=if(attrn('Account',!Account,'signswitch')=0,\n\t(DB('Income Statement',!Currency Calc,!Organization ,!Year,!Month,!Account,DB('Calendar', 'Current Version', 'String'))\n\t        -DB('Income Statement',!Currency Calc,!Organization ,!Year,!Month,!Account ,DB('Calendar', 'Compare Against', 'String'))) * ATTRN('Version',DB('Calendar', 'Compare Against', 'String'),'VarianceFactor')\n\t,(DB('Income Statement',!Currency Calc,!Organization ,!Year,!Month,!Account ,DB('Calendar', 'Compare Against', 'String'))\n\t        -DB('Income Statement', !Currency Calc,!Organization ,!Year,!Month,!Account ,DB('Calendar', 'Current Version', 'String')))*ATTRN('Version',DB('Calendar', 'Compare Against', 'String'),'VarianceFactor'));\n['Variance%']=['Variance']\\DB('Income Statement',!Currency Calc,!Organization ,!Year,!Month,!Account ,DB('Calendar', 'Current Version', 'String'))*100;\n#EndRegion\n\n\n#Region Target vs Prior Year Actual\n['Target vs Prior Year Actual']=if(attrn('Account',!Account,'signswitch')=0,['Target']-['Prior Year Actual'],['Prior Year Actual']-['Target'])*-1;\n['Target vs Prior Year Actual %']=(['Target vs Prior Year Actual']\\RoundP(['Prior Year Actual'],0))*100;\n#EndRegion\n\n#Region Currency Conversion\n['FTE','Base'] = n: ['FTE','Local'];\n['Square Footage','Base'] = n: ['Square Footage','Local'];\n['Server Space','Base'] = n: ['Server Space','Local'];\n['Shares','Base'] = n: ['Shares','Local'];\n['Base' ]  = n: ['Local']* DB('Exchange Rates', ATTRS('Organization', !Organization, 'Currency'), !Year, !Month, 'ExchangeRate', ATTRS('Account', !Account, 'Exchange Rate Type'), !Version);\n#EndRegion\n\n#Region Prior Year Actual\n['Local','Prior Year Actual'] = n: DB('Income Statement','Local',!organization,ATTRS('Year',!Year,'Prev'),!Month,!Account,'Actual');\n#EndRegion\n\n#Region Get Version for Dashboard\n['Dashboard','Local'] = n: DB('Income Statement','Local', !organization, !Year, !Month, !Account, DB('Calendar', 'Current Version', 'String')) ;\n['DashboardCA','Local'] = n: DB('Income Statement','Local', !organization, !Year, !Month, !Account, DB('Calendar', 'Compare Against', 'String')) ;\n#EndRegion\n\n#Region EPS\n['Total Company','EPS','Local'] = C: DB('Income Statement', !Currency Calc,'Total Company', !Year, !Month,'NP', !Version)\\DB('Income Statement', !Currency Calc, '101', !Year, !Month, 'Shares', !Version);\n['Total Company','EPS','Base'] = C: DB('Income Statement', !Currency Calc,'Total Company', !Year, !Month,'NP', !Version)\\DB('Income Statement', 'Local', '101', !Year, !Month, 'Shares', !Version);\n['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Account':{'Shares','FTE','Square Footage','Server Space'}]\n    =C: DB('Income Statement', !Currency Calc, !organization, !Year, ATTRS('Month', !Month, 'lastperiod'), !Account, !Version);\n#EndRegion\n\n#Region Forecasting\n# Populate the Actual Months in the Forecast\n['Forecast','Local']= n: IF(DB('Relative Time', !Year, !Month, 'ActFor')@='A',['Actual'],CONTINUE);\n# Rolling 3 Month Average\n['Forecast','Local']= n: IF(DB('Relative Time', !Year, !Month, 'ActFor')@='F' & DB('FcstMethod',!Account,'FcstMethod')@='Average Prior 3 Months',\n     ( DB('Income Statement',!Currency Calc,!organization,DB('Relative Time', !Year, !Month, 'CM-1Y'),DB('Relative Time', !Year, !Month, 'M-1'),!Account,!Version) +\n       DB('Income Statement',!Currency Calc,!organization,DB('Relative Time', !Year, !Month, 'CM-2Y'),DB('Relative Time', !Year, !Month, 'M-2'),!Account,!Version) +\n       DB('Income Statement',!Currency Calc,!organization,DB('Relative Time', !Year, !Month, 'CM-3Y'),DB('Relative Time', !Year, !Month, 'M-3'),!Account,!Version) ) /3\n,CONTINUE);\n# Last Year Actual\n['Forecast','Local']= n: IF(DB('Relative Time', !Year, !Month, 'ActFor')@='F' & DB('FcstMethod',!Account,'FcstMethod')@='Last Year Actual',\n     DB('Income Statement',!Currency Calc,!organization,DB('Relative Time', !Year, !Month, 'CMPYY'),DB('Relative Time', !Year, !Month, 'CMPY'),!Account,'Actual')\n,CONTINUE);\n# Budget\n['Forecast','Local']= n: IF(DB('Relative Time', !Year, !Month, 'ActFor')@='F' & DB('FcstMethod',!Account,'FcstMethod')@='Budget',\n     DB('Income Statement',!Currency Calc,!organization,!Year,!Month,!Account,DB('Calendar','Current Version','String'))\n,CONTINUE);\n#Remaining Budget\n['Forecast','Local']= n: IF(DB('Relative Time', !Year, !Month, 'ActFor')@='F' & DB('FcstMethod',!Account,'FcstMethod')@='Remaining Budget',\n  DB('Income Statement', 'Local', !organization, !Year, !Month,!Account, DB('Calendar','Current Version','String')) +\n (\n   (\n     DB('Income Statement', 'Local', !organization, !Year, ATTRS('Month',ATTRS('Month',!Month,'previousperiod'),'YTD'),!Account, DB('Calendar','Current Version','String'))-\n     DB('Income Statement', 'Local', !organization, !Year, ATTRS('Month',ATTRS('Month',!Month,'previousperiod'),'YTD'),!Account, 'Forecast')\n    ) *\n    (\n      DB('Income Statement', 'Local', !organization, !Year, !Month,!Account, DB('Calendar','Current Version','String')) \\\n      (\n\t    DB('Income Statement', 'Local', !organization, !Year, 'Year',!Account, DB('Calendar','Current Version','String')) -\n\t    DB('Income Statement', 'Local', !organization, !Year, ATTRS('Month',ATTRS('Month',!Month,'previousperiod'),'YTD'),!Account, DB('Calendar','Current Version','String'))\n      )\n    )\n  )\n,CONTINUE);\n\n#EndRegion\n\n#Region C-Calculation rules: Dimension:Account\n#Autogenerated CALC CONSOLIDATED 4163636F756E74\n   #Region Dimension:Account, Member:Rev per FTE\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B4163636F756E745D2E5B52657620706572204654455D\n   #@AutoGenerated\n   ['Account':{'Rev per FTE'}]=C:['Account':'4999']\\['Account':'FTE'];\n   #EndRegion\n   #Region Dimension:Account, Member:Cost per FTE\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B4163636F756E745D2E5B436F737420706572204654455D\n   #@AutoGenerated\n   ['Account':{'Cost per FTE'}]=C:['Account':'TE']\\['Account':'FTE'];\n   #EndRegion\n#EndRegion\n\n#Region N-Calculation rules: Dimension:Account\n#Autogenerated CALC NUMERIC 4163636F756E74\n   #Region Dimension:Account, Member:Rev per FTE\n   #Autogenerated MEMBERCALC NUMERIC 5B4163636F756E745D2E5B52657620706572204654455D\n   #@AutoGenerated\n   ['Account':{'Rev per FTE'}]=N:['Account':'4999']\\['Account':'FTE'];\n   #EndRegion\n   #Region Dimension:Account, Member:Cost per FTE\n   #Autogenerated MEMBERCALC NUMERIC 5B4163636F756E745D2E5B436F737420706572204654455D\n   #@AutoGenerated\n   ['Account':{'Cost per FTE'}]=N:['Account':'TE']\\['Account':'FTE'];\n   #EndRegion\n#EndRegion\n\n\n#Region Bring in The Headcount Section\n#Salary\n['Local','6000']= n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Compensation', !Organization,'Total', !Month,!Year,!Version, '6000'),CONTINUE);\n# Bonus\n['Local','6005']= n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Compensation', !Organization,'Total', !Month,!Year,!Version, '6005'),CONTINUE);\n# Benefits\n['Local','6010']= n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Compensation', !Organization,'Total', !Month,!Year,!Version, '6010'),CONTINUE);\n# Employer Taxes\n['Local','6015']= n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Compensation', !Organization,'Total', !Month,!Year,!Version, '6015'),CONTINUE);\n# Headcount\n['Local','FTE']= n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Compensation', !Organization,'Total', !Month,!Year,!Version, 'FTE'),CONTINUE);\n#EndRegion\n\n#Region - Bring in The Revenue\n['Local','4999'] = n: IF(ATTRS('Version',!Version,'Version Type') @= 'B', DB('Revenue',!organization, 'Channel Total', 'Product Total', !Month, !Year,!Version,'Gross Revenue'),CONTINUE);\n['Local','5999'] = n: IF(ATTRS('Version',!Version,'Version Type') @= 'B', DB('Revenue',!organization, 'Channel Total', 'Product Total', !Month, !Year,!Version,'Cost of Sales'),CONTINUE);\n#EndRegion\n\n#Region Bring in the Line Item Detail\n['6400','Local'] = n: IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Line Item Detail',!organization, !Account, 'Total', !Year, !Version, 'Total',!Month),CONTINUE);\n['6410','Local'] = n: IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Line Item Detail',!organization, !Account, 'Total', !Year, !Version, 'Total',!Month),CONTINUE);\n#EndRegion\n\n#Region Phased Costs\n# 6300\n['Local','6300']=n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',\nDB('Phased Costs',!organization,!Account,!Year,!Version,'Full Year Cost')\n*DB('Spread Methods',DB('Phased Costs',!organization,!Account,!Year,!Version,'Spread Method'),!Month,!Version)\n\\DB('Spread Methods',DB('Phased Costs',!organization,!Account,!Year,!Version,'Spread Method'),'Year',!Version)\n,CONTINUE);\n# 6310\n['Local','6310']=n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',\nDB('Phased Costs',!organization,!Account,!Year,!Version,'Full Year Cost')\n*DB('Spread Methods',DB('Phased Costs',!organization,!Account,!Year,!Version,'Spread Method'),!Month,!Version)\n\\DB('Spread Methods',DB('Phased Costs',!organization,!Account,!Year,!Version,'Spread Method'),'Year',!Version)\n,CONTINUE);\n# 6320\n['Local','6320']=n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',\nDB('Phased Costs',!organization,!Account,!Year,!Version,'Full Year Cost')\n*DB('Spread Methods',DB('Phased Costs',!organization,!Account,!Year,!Version,'Spread Method'),!Month,!Version)\n\\DB('Spread Methods',DB('Phased Costs',!organization,!Account,!Year,!Version,'Spread Method'),'Year',!Version)\n,CONTINUE);\n#EndRegion\n\n#Region Bring in the Depreciation\n# New\n['6520','Local'] = n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Depreciation', !organization, 'Asset Total', !Month, !Year,!Version, '6520'),CONTINUE);\n# Existing\n['6510','Local'] = n:IF(ATTRS('Version',!Version,'Version Type') @= 'B',DB('Depreciation', !organization, 'Asset Total', !Month, !Year,!Version, '6510'),CONTINUE);\n#EndRegion\n\n#Region Bring in the Allocations\n\n#[{'6600','6610'},'Local','Y1','Actual']=STET;\n\n['6600','Local'] = n:IF(ATTRS('Version',!Version,'Version Type') @= 'B' %\n                        ATTRS('Version',!Version,'Version Type') @= 'A' %\n                        ATTRS('Version',!Version,'Version Type') @= 'T'\n                     ,DB('Allocation Calculation', !organization, 'All Allocations', !Year, !Month, !Version, 'Allocated Amount'),CONTINUE);\n['6610','Local'] = n:IF(ATTRS('Version',!Version,'Version Type') @= 'B' %\n                        ATTRS('Version',!Version,'Version Type') @= 'A' %\n                        ATTRS('Version',!Version,'Version Type') @= 'T'\n                     ,DB('Allocation Calculation', !organization, 'All Allocations', !Year, !Month, !Version, 'Credit Amount'),CONTINUE);\n#EndRegion\n\nFEEDERS;\n\n#Region Currency Calculation\n['Local']=>['Base'];\n#EndRegion\n\n#Region Currency Variance Calcs\n['Local']=>DB(IF(DIMNM('Version', DIMIX('Version', !Version))@=DB('Calendar', 'Current Version', 'String'),'Income Statement',''), 'Base', !organization, !Year, !Month, !Account, 'Performance Variance');\n['Local']=>DB(IF(DIMNM('Version', DIMIX('Version', !Version))@=DB('Calendar', 'Current Version', 'String'),'Income Statement',''), 'Base', !organization, !Year, !Month, !Account, 'Ccy Exchange Variance');\n#EndRegion\n\n\n#Region Target vs Prior Year Actual\n['Prior Year Actual']=>['Target vs Prior Year Actual'],['Target vs Prior Year Actual %'];\n['Target']=>['Target vs Prior Year Actual'],['Target vs Prior Year Actual %'];\n\n#EndRegion\n\n#Region Variance Calculation\n#['Local']=>DB(IF(DIMNM('Version', DIMIX('Version', !Version))@=DB('Calendar', 'Current Version', 'String'),'Income Statement',''),'Local',!organization, !Year, !Month, !Account,'Variance');\n['Actual']=>['Variance'];\n['Variance']=>['Variance%'],['Performance Variance'],['Ccy Exchange Variance'];\n#EndRegion\n\n#Region Prior Year Version\n['Actual','Local'] => DB('Income Statement','Local',!organization,ATTRS('Year',!Year,'Next'),!Month,!Account,'Prior Year Actual');\n#EndRegion\n\n#Region Dashboard Version\n#['Local']=>DB(IF(DIMNM('Version', DIMIX('Version', !Version))@=DB('Calendar', 'Current Version', 'String'),'Income Statement',''), 'Local', !organization, !Year, !Month, !Account, 'Dashboard');\n#['Local']=>DB(IF(DIMNM('Version', DIMIX('Version', !Version))@=DB('Calendar', 'Compare Against', 'String'),'Income Statement',''), 'Local', !organization, !Year, !Month, !Account, 'DashboardCA');\n['Actual']=>['Dashboard'];\n['Actual']=>['DashboardCA'];\n#EndRegion\n\n#Region Forecast Version\n['Actual']=>['Forecast'];\n#EndRegion\n\n#DB('Income Statement', !Currency Calc, !organization, !Year, !Month, !Account, !Version);\n\n#Region Feed the Income Statement Reporting Cube\n[ ] =>DB('Income Statement Reporting', !Currency Calc, !organization, !Year, !Month, !Account, !Version);\n#EndRegion\n\n#Region YoY Variances\n[{'Y1','Y2'}]=> ['Y2-Y1 $'];\n['Y2-Y1 $']=> ['Y2-Y1 %'];\n#EndRegion\n\n#Region EPS\n['Shares']=>['EPS'];\n#EndRegion\n\n\n#Region Automatically generated feeders\n#Autogenerated AUTOFEEDERS\n['Account':'FTE', 'Version':{'Version 1', 'Performance Variance', 'Target vs Prior Year Actual %', 'Ccy Exchange Variance', 'Variance%', 'Prior Year Actual', 'Variance', 'Dashboard', 'Target', 'Volume Variance', 'Predictive', 'Zero', 'DashboardCA', 'Predictivev2', 'Target vs Prior Year Actual', 'Version 2', 'Actual', 'Forecast', 'Rate Variance'}] => ['Account':'Rev per FTE'];\n['Currency Calc':'Base', 'Version':'Dashboard'] => DB('Metrics', !Account, !organization, !Year, !Month, 'Target');\n['Currency Calc':'Base', 'Version':'DashboardCA'] => DB('Metrics', !Account, !organization, !Year, !Month, 'Actual');\n['Currency Calc':'Base', 'Version':'Forecast'] => DB('Metrics', !Account, !organization, !Year, !Month, 'Forecast');\n['Account':'TE', 'Version':{'Version 1', 'Performance Variance', 'Target vs Prior Year Actual %', 'Ccy Exchange Variance', 'Variance%', 'Prior Year Actual', 'Variance', 'Dashboard', 'Target', 'Volume Variance', 'Predictive', 'Zero', 'DashboardCA', 'Predictivev2', 'Target vs Prior Year Actual', 'Version 2', 'Actual', 'Forecast', 'Rate Variance'}] => ['Account':'Cost per FTE'];\n#EndRegion"
}