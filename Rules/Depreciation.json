{
    "Name": "Depreciation",
    "Rules": "#Region System\nFEEDSTRINGS;\nSKIPCHECK;\nUNDEFVALS;\n#EndRegion\nUNDEFVALS;\n#UNDEFVALS;\n\n#Region N-Calculation rules: Dimension:Depreciation\n#Autogenerated CALC NUMERIC 446570726563696174696F6E\n   #Region Dimension:Depreciation, Member:YTD Additions\n   #Autogenerated MEMBERCALC NUMERIC 5B446570726563696174696F6E5D2E5B595444204164646974696F6E735D\n   ##CUMULATE : calculates the cumulative totals in output member cell based on the orginal values in the input member cell\n   ['Depreciation':'YTD Additions']=N:DB('Depreciation', !organization, !Asset Types, !Month, !Year, !Version, 'Additions')+DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'previousperiod'), !Year, !Version, 'YTD Additions');\n   #EndRegion\n   #Region Dimension:Depreciation, Member:YTD In Service\n   #Autogenerated MEMBERCALC NUMERIC 5B446570726563696174696F6E5D2E5B59544420496E20536572766963655D\n   ##CUMULATE : calculates the cumulative totals in output member cell based on the orginal values in the input member cell\n   ['Depreciation':'YTD In Service']=N:DB('Depreciation', !organization, !Asset Types, !Month, !Year, !Version, 'In Service')+DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'previousperiod'), !Year, !Version, 'YTD In Service');\n   #EndRegion\n   #Region Dimension:Depreciation, Member:Cost End Bal\n   #Autogenerated MEMBERCALC NUMERIC 5B446570726563696174696F6E5D2E5B436F737420456E642042616C5D\n   ['Depreciation':'Cost End Bal']=N:((['Depreciation':'Cost Beg Bal']+['Depreciation':'In Service'])+['Depreciation':'Adjustments']);\n   #EndRegion\n#EndRegion\n\n#Region C-Calculation rules: Dimension:Depreciation\n#Autogenerated CALC CONSOLIDATED 446570726563696174696F6E\n   #Region Dimension:Depreciation, Member:YTD Additions\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B595444204164646974696F6E735D\n   ##CUMULATE : calculates the cumulative totals in output member cell based on the orginal values in the input member cell\n   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'YTD Additions'}]=C:IF(DIMIX('Month', ATTRS('Month', !\n   Month, 'lastperiod'))>0,\n   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'YTD Additions'),\n   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'YTD Additions'));\n   #EndRegion\n   #Region Dimension:Depreciation, Member:YTD In Service\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B59544420496E20536572766963655D\n   ##CUMULATE : calculates the cumulative totals in output member cell based on the orginal values in the input member cell\n   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'YTD In Service'}]=C:IF(DIMIX('Month', ATTRS('Month', \n   !Month, 'lastperiod'))>0,\n   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'YTD In Service'),\n   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'YTD In Service'));\n   #EndRegion\n   #Region Dimension:Depreciation, Member:Cost End Bal\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B436F737420456E642042616C5D\n   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Cost End Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !M\n   onth, 'lastperiod'))>0,\n   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'Cost End Bal'),\n   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'Cost End Bal'));\n   #EndRegion\n   #Region Dimension:Depreciation, Member:Depr Beg Bal\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B44657072204265672042616C5D\n   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Depr Beg Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !M\n   onth, 'firstperiod'))>0,\n   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'firstperiod'), !Year, !Version, 'Depr Beg Bal'),\n   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, 1), !Year, !Version, 'Depr Beg Bal'));\n   #EndRegion\n   #Region Dimension:Depreciation, Member:Depr End Bal\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B4465707220456E642042616C5D\n   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Depr End Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !M\n   onth, 'lastperiod'))>0,\n   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'Depr End Bal'),\n   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'Depr End Bal'));\n   #EndRegion\n   #Region Dimension:Depreciation, Member:Asset Beg Bal\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B4173736574204265672042616C5D\n   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Asset Beg Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !\n   Month, 'firstperiod'))>0,\n   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'firstperiod'), !Year, !Version, 'Asset Beg Bal'),\n   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, 1), !Year, !Version, 'Asset Beg Bal'));\n   #EndRegion\n   #Region Dimension:Depreciation, Member:Asset End Bal\n   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B417373657420456E642042616C5D\n   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Asset End Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !\n   Month, 'lastperiod'))>0,\n   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'Asset End Bal'),\n   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'Asset End Bal'));\n   #EndRegion\n#EndRegion\n\n#Region Link rule: Dep:Cap_Additions - Numeric\n#Source cube: Capital\n#Target cube: Depreciation\n#Autogenerated LINK NUMERIC 7D4C696E6B5F4465705F33414361705F4164646974696F6E73\n['Depreciation':'Additions'] = N:(DB('}ICube_}Link_Dep_3ACap_Additions',\n    !Month, !organization, '1', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_Additions',\n    !Month, !organization, '2', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_Additions',\n    !Month, !organization, '3', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_Additions',\n    !Month, !organization, '4', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_Additions',\n    !Month, !organization, '5', !Asset Types, !Year, !Version,\n    'Purchase Cost'));\n#EndRegion\n\n#Region Link rule: Dep:Cap_InService - Numeric\n#Source cube: Capital\n#Target cube: Depreciation\n#Autogenerated LINK NUMERIC 7D4C696E6B5F4465705F33414361705F496E53657276696365\n['Depreciation':'In Service'] = N:(DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '1', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '2', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '3', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '4', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '5', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '6', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '7', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '8', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '9', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '10', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '11', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '12', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '13', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '14', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '15', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '16', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '17', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '18', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '19', !Asset Types, !Year, !Version,\n    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',\n    !Month, !organization, '20', !Asset Types, !Year, !Version,\n    'Purchase Cost'));\n#EndRegion\n\n#Region Custom Calc\n   #Region Beb Bal\n   ['Cost Beg Bal']=N:IF((ATTRN('Year',!Year,'Index')=1 & DIMIX('Month',!Month) =3),STET,CONTINUE);\n      ['Cost Beg Bal']=N:IF(DIMIX('Month',!Month)=3,\n   DB('Depreciation',!Organization,!Asset Types,'Dec',ATTRS('Year',!Year,'Prev'),!Version,'Cost End Bal'),\n   DB('Depreciation',!Organization,!Asset Types,ATTRS('Month',!Month,'previousperiod'),!Year,!Version,'Cost End Bal'));\n   #EndRegion\n   #Region Depreciation\n      ['Depr Beg Bal']=N:IF((ATTRN('Year',!Year,'Index')=1 & DIMIX('Month',!Month) =3),STET,CONTINUE);\n      ['Depr Beg Bal']=N:IF(DIMIX('Month',!Month)=3,\n   DB('Depreciation',!Organization,!Asset Types,'Dec',ATTRS('Year',!Year,'Prev'),!Version,'Depr End Bal'),\n   #\t\t\t\t\tDB('Depreciation Calc',!Version,!Asset Types,!Organization,ATTRS('Year',!Year,'Prev'),'Depr End Bal','Dec'),\n      DB('Depreciation',!organization,!Asset Types,ATTRS('Month',!Month,'previousperiod'),!Year,!Version,'Depr End Bal'));\n   #\t\t\t\t\tDB('Depreciation Calc',!Version,!Asset Types,!Organization,!Year,'Depr End Bal',ATTRS('Month',!Month,'Prev')));\n      ['6520 Depr on Additions']=N:['YTD In Service'] \\ DB('Asset Life',!Asset Types,!Version,'Asset Life');\n            ['Total Depreciation']=N:['6520 Depr on Additions'] + ['6510 Depr on Existing Assets'];\n      ['Depr End Bal']=N:['Depr Beg Bal'] + ['Total Depreciation'];\n   #===============================BALANCE SHEET=========================================\n      ['Asset Beg Bal']=N:IF((ATTRN('Year',!Year,'Index')=1 & DIMIX('Month',!Month) =3),STET,CONTINUE);\n      ['Asset Beg Bal']=N:IF(DIMIX('Month',!Month)=3,\n   DB('Depreciation',!Organization,!Asset Types,'Dec',ATTRS('Year',!Year,'Prev'),!Version,'Asset End Bal'),\n   #\t\t\t\t\tDB('Depreciation Calc',!Version,!Asset Types,!Organization,ATTRS('Year',!Year,'Prev'),'Asset End Bal','Dec'),\n      DB('Depreciation',!Organization,!Asset Types,ATTRS('Month',!Month,'previousperiod'),!Year,!Version,'Asset End Bal'));\n   #\t\t\t\t\tDB('Depreciation Calc',!Version,!Asset Types,!Organization,!Year,'Asset End Bal',ATTRS('Month',!Month,'Prev')));\n      ['Asset End Bal']=N:['Asset Beg Bal'] + ['Additions']-['Total Depreciation'];\n   #EndRegion\n\n\n\n#EndRegion\n\n\n\nFEEDERS;\n\n\n#Region FEED The Income Statement\n#['6510']=>DB(IF(ATTRS('Version',!Version,'LinkVersion')@<>'','Income Statement',''),'Local', !organization, !Year, !Month, '6510', !Version);\n#['6520']=>DB(IF(ATTRS('Version',!Version,'LinkVersion')@<>'','Income Statement',''),'Local', !organization, !Year, !Month, '6520', !Version);\n#EndRegion"
}